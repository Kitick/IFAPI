"use strict";class StateCache{#t=new Map;constructor(){}#e(t){let e;switch(t.type){case"number":e=parseFloat(t.value);break;case"checkbox":e=t.checked;break;case"select-one":e=t.value;break;default:e=null}"number"===t.type&&"number"==typeof e&&isNaN(e)&&(e=null);let a=this.#t.get(t.id);void 0!==a&&(a.value=e)}#a(t){t.classList.add("error"),setTimeout((()=>{t.classList.remove("error")}),2e3)}addArray(t){t.forEach((t=>{if(void 0===this.#t.get(t)){const e=document.getElementById(t);if(null!==e&&"INPUT"===e.tagName){const t=e;t.addEventListener("change",(()=>{this.#e(t)})),this.#t.set(t.id,{dom:t,value:null}),this.#e(t)}}}))}add(...t){this.addArray(t)}loadArray(t){let e=new Map;return t.forEach((t=>{let a=this.#t.get(t);void 0!==a&&e.set(t,a.value)})),e}load(...t){return this.loadArray(t)}loadAll(){let t=new Map;return this.#t.forEach(((e,a)=>{t.set(a,e.value)})),t}save(t,e){const a=this.#t.get(t);if(void 0===a)return;a.value=e;const o=a.dom;"checkbox"===o.type&&"boolean"==typeof e?o.checked=e:"string"==typeof e&&(o.value=e)}isValid(t,e=!1){const a=this.#t.get(t);if(void 0===a)return!1;const o=null!==a.value;return!o&&e&&this.#a(a.dom),o}isValidArray(t,e=!1){let a=!0;return t.forEach((t=>{a=this.isValid(t,e)&&a})),a}}class profileStorage{#o;constructor(t){this.#o=t,this.#n()}#n(){let t=[""];for(let e=0,a=localStorage.length;e<a;e++)t.push(localStorage.key(e));t.sort(),this.#o.innerHTML="",t.forEach((t=>{let e=new Option(t,t);this.#o.appendChild(e)}))}#i(t,e){const a=document.getElementById(t);null!==a&&(a.className=e,setTimeout((()=>{a.className="off"}),500))}add(){let t=prompt("Enter the name of the profile:");for(;""===t;)t=prompt("Name cannot be blank:");null!==t&&(localStorage.setItem(t,""),this.#n(),this.#o.value=t,this.save())}save(){const t=this.#o.value;if(""===t)return void this.add();const e=autofunction.cache.loadAll();localStorage.setItem(t,JSON.stringify(e)),this.#i("save","active")}load(){const t=this.#o.value;let e=localStorage.getItem(t);if(""===t||null===e)return void this.#i("load","error");const a=JSON.parse(e);for(let t in a)autofunction.cache.save(t,a[t]);this.#i("load","active")}remove(){const t=this.#o.value;if(""===t)return;confirm("Are you sure you want to delete: "+t)&&(localStorage.removeItem(t),this.#n())}}class autofunction{delay;#s;#l=setTimeout((()=>{}),0);#c=new Map;#r=[];#u=[];#d=0;#g=0;#f=!1;#h=!1;#p;stage=0;static cache=new StateCache;constructor(t,e,a,o,n,i){this.delay=e;const s=document.getElementById(t);if(null===s||"BUTTON"!==s.tagName)throw"Trigger is not a button";this.#s=s,this.#v(),this.#d=o.length,this.#r=a,this.#u=n,this.#p=i,o.forEach((t=>{this.#c.set(t,null)})),autofunction.cache.addArray(a)}get active(){return this.#f}set active(t){this.setActive(t)}get inputs(){return this.#r}get dependents(){return this.#u}setActive(t=!this.#f){this.active!==t&&(this.#f=t,this.#v(),t?(this.stage=0,this.#m()):clearTimeout(this.#l))}#v(){this.#s.className=this.active?"active":"off"}#m(){const t=this.validateInputs(!0);t?this.#y((()=>{const e=this.#h;this.#h=!1,this.#p({states:this.#c,inputs:autofunction.cache.loadArray(this.inputs)}),!this.#h&&e&&this.#v(),-1===this.delay&&(this.active=!1),this.active&&t&&(this.#l=setTimeout((()=>{this.#m()}),this.delay))})):this.error()}#y(t){if(0===this.#d)t();else{this.#g=0;for(let e in this.#c)read(e,(a=>{this.#w(e,a,t)}))}}#w(t,e,a){this.#c.set(t,e),this.#g++,this.#g===this.#d&&a()}validateInputs(t=!1){let e=autofunction.cache.isValidArray(this.inputs,t);return this.#u.forEach((a=>{e=autofunction.cache.isValidArray(a.inputs,t)&&e})),e}arm(){this.#h=!0,this.#s.className="armed"}error(){this.active=!1,this.#s.className="error",this.#l=setTimeout((()=>{this.#v()}),2e3)}}function cyclical(t,e=360){return t=(t%e+e)%e}function dms(t,e=0,a=0){return Math.sign(t)*(Math.abs(t)+e/60+a/3600)}function calcLLfromHD(t,e,a,o,n=0){a=90-a-n,a*=toRad;const i=(o/=60)*Math.sin(a)+t;return[i,o*Math.cos(a)/Math.cos(toRad*(t+i)*.5)+e]}function calcLLdistance(t,e,a,o){const n=60*(a-t);return((60*(o-e)*Math.cos(.5*(t+a)*toRad))**2+n**2)**.5}function controlThrottle(t,e,a){write("spdon",!1),write("throttle",t>0?-80:-100),write("spd",e),write("spoilers",1),a&&(write("spdon",!0),write("spoilers",2))}function showfpl(t,e,a){const o=document.createElement("input"),n=document.createElement("br");o.type="number",o.id=t,a.innerHTML+=" "+e,a.appendChild(o),a.appendChild(n)}function speak(t){t=t.toString();const e=document.getElementById("voices"),a=speechSynthesis.getVoices(),o=e.selectedIndex;let n=document.getElementById("utterancerate").value;""===n&&(n=1);const i=new SpeechSynthesisUtterance(t);i.rate=n,i.voice=a[o],speechSynthesis.speak(i)}speechSynthesis.getVoices();const toDeg=180/Math.PI,toRad=Math.PI/180;function setAll(t){const e="off"===t;autogear.active=e,autospoilers.active=e,autotrim.active=e,autoflaps.active=e,autolights.active=e,autobrakes.active=e,autospeed.active=e,document.getElementById("all").className=e?"active":"off"}function config(){const t={autoflaps:{instance:autoflaps,checked:document.getElementById("configflaps").checked},autospeed:{instance:autospeed,checked:document.getElementById("configspeed").checked},autotakeoff:{instance:autotakeoff,checked:document.getElementById("configtakeoff").checked},flypattern:{instance:flypattern,checked:document.getElementById("configpattern").checked},autoland:{instance:autoland,checked:document.getElementById("configland").checked}};let e=[];for(const a in t)if(t[a].checked){const o=t[a].instance.inputs,n=t[a].instance.dependents;o.forEach((t=>{-1===e.indexOf(t)&&e.push(t)})),n.forEach((t=>{t.inputs.forEach((t=>{-1===e.indexOf(t)&&e.push(t)}))}))}e.forEach((t=>{const e=document.getElementById(t);if("number"===e.type){const a=prompt(e.placeholder+"\nLeave blank to not change");""!==a&&(e.value=a,autofunction.cache.save(t,a))}}))}function dependencyCheck(t){"autoland"===t&&autoland.active&&autofunction.cache.load("approach")?autofunction.cache.save("approach",!1):"flypattern"===t&&flypattern.active?(autoland.active=!1,flyto.active=!1):"flyto"===t&&flyto.active&&(flypattern.active=!1,autoland.active=!1)}const autotrim=new autofunction("trim",1e3,[],["pitch","trim","onground"],[],(t=>{const e=t.states,a=e.get("onground"),o=e.get("pitch"),n=e.get("trim");if(a)return void autotrim.arm();let i=10;if(Math.abs(o)<10?i=1:Math.abs(o)<50&&(i=5),Math.abs(o)>=2){let t=n+i*Math.sign(o);t=Math.round(t/i)*i,write("trim",t)}})),autolights=new autofunction("lights",2e3,[],["altitudeAGL","onground","onrunway","gear"],[],(t=>{const e=t.states,a=e.get("altitudeAGL"),o=e.get("onground"),n=e.get("onrunway"),i=e.get("gear");write("master",!0),write("beaconlights",!0),write("navlights",!0),o?(write("strobelights",n),write("landinglights",n)):(write("strobelights",!0),write("landinglights",!!(a<1e3&&i)))})),autogear=new autofunction("gear",1e3,[],["gear","altitudeAGL","verticalspeed"],[],(t=>{const e=t.states,a=e.get("gear"),o=e.get("altitudeAGL"),n=e.get("verticalspeed");let i=a;o<100||n<=-500&&o<1500?i=!0:(n>=500||o>=2e3)&&(i=!1),i!==a&&read("commands/LandingGear")})),autobrakes=new autofunction("autobrakes",1e3,[],["leftbrake","rightbrake","autobrakes","onground","onrunway","groundspeed"],[],(t=>{const e=t.states,a=e.get("leftbrake"),o=e.get("rightbrake"),n=e.get("autobrakes"),i=e.get("onground"),s=e.get("onrunway"),l=e.get("groundspeed");let c=n;i&&!s?c=0:i?s&&(c=3):c=2,i&&l>30&&(a>.3||o>.3)&&(c=0),c!==n&&write("autobrakes",c)})),autoflaps=new autofunction("flaps",1e3,["flaplow","flaphigh","flapto"],["flaps","airspeed","altitudeAGL","verticalspeed","flapcount","onground","onrunway"],[],(t=>{const e=t.inputs,a=t.states,o=e.get("flaplow"),n=e.get("flaphigh"),i=e.get("flapto"),s=a.get("flaps"),l=a.get("airspeed"),c=a.get("altitudeAGL"),r=a.get("verticalspeed"),u=a.get("flapcount"),d=a.get("onground"),g=a.get("onrunway");if(i<0||i>u-1||n<o)return void autoflaps.error();let f=s;if(d)f=g?i:0;else if(c>=250){const t=u-1,e=(n-o)/t;f=Math.round((n-l)/e),f=Math.max(f,0),f=Math.min(f,t)}(r>=500&&f>s||r<=-500&&f<s)&&(f=s),f!==s&&write("flaps",f)})),autospoilers=new autofunction("spoilers",1e3,[],["spoilers","airspeed","spd","altitude","altitudeAGL","onrunway","onground"],[],(t=>{const e=t.states,a=e.get("spoilers"),o=e.get("airspeed"),n=e.get("spd"),i=e.get("altitude"),s=e.get("altitudeAGL"),l=e.get("onrunway"),c=e.get("onground");let r=0;l||!c&&s<1e3?r=2:o-n>=20&&i<28e3&&(r=1),r!==a&&write("spoilers",r)})),levelchange=new autofunction("levelchange",1e3,["flcinput","flcmode"],["airspeed","altitude","alt","vs"],[],(t=>{const e=t.inputs,a=t.states,o=e.get("flcinput"),n=e.get("flcmode"),i=a.get("airspeed"),s=a.get("altitude"),l=a.get("alt"),c=a.get("vs");let r=o;const u=l-s;Math.abs(u)<100?levelchange.active=!1:("v"===n&&(r=6076.12*Math.tan(r*toRad)),"f"!==n&&(r*=Math.sign(u)*(i/60)),r=100*Math.round(r/100),r!==c&&write("vs",r))})),markposition=new autofunction("markposition",-1,[],["latitude","longitude","altitude","heading"],[],(t=>{const e=t.states,a=e.get("latitude"),o=e.get("longitude"),n=e.get("altitude"),i=e.get("heading");autofunction.cache.save("latref",a),autofunction.cache.save("longref",o),autofunction.cache.save("hdgref",Math.round(i)),autofunction.cache.save("altref",Math.round(n))})),setrunway=new autofunction("setrunway",-1,[],["route","coordinates"],[],(t=>{const e=t.states,a=e.get("route"),o=e.get("coordinates"),n=a.split(",");let i=-1;for(let t=0,e=n.length;t<e;t++)if(0===n[t].search(/RW\d\d.*/)){i=t;break}if(-1===i)return void setrunway.error();const s=o.split(" ")[i].split(","),l=parseFloat(s[0]),c=parseFloat(s[1]),r=parseInt(a[i][2]+a[i][3]+"0");autofunction.cache.save("latref",l),autofunction.cache.save("longref",c),autofunction.cache.save("hdgref",r)})),flyto=new autofunction("flyto",1e3,["flytolat","flytolong","flytohdg"],["latitude","longitude","variation","groundspeed","wind","winddir"],[],(t=>{const e=t.inputs,a=t.states,o=e.get("flytolat"),n=e.get("flytolong"),i=e.get("flytohdg"),s=a.get("latitude"),l=a.get("longitude"),c=a.get("variation"),r=a.get("groundspeed"),u=a.get("wind"),d=a.get("winddir");if(calcLLdistance(s,l,o,n)<1)return void(flyto.active=!1);const g=60*(o-s),f=60*(n-l)*Math.cos(.5*(s+o)*toRad);let h=cyclical(Math.atan2(f,g)*toDeg-c);let p=cyclical(i)-h;p>180?p-=360:p<-180&&(p+=360),Math.abs(p)<5?h-=-.1*p**3+8.5*p:h-=30*Math.sign(p);let v=90-h,m=90-cyclical(d-c+180);v*=toRad,m*=toRad;const y=2*r*Math.cos(v),w=2*r*Math.sin(v),k=u*Math.cos(m),b=u*Math.sin(m);h=cyclical(Math.atan2(y-k,w-b)*toDeg),write("hdg",h)})),flypattern=new autofunction("flypattern",1e3,["latref","longref","hdgref","updist","downwidth","finallength","turnconst","leg","direction","approach"],["latitude","longitude","variation","groundspeed"],[],(t=>{const e=t.inputs,a=t.states,o=e.get("latref"),n=e.get("longref"),i=e.get("hdgref"),s=e.get("updist"),l=e.get("downwidth"),c=e.get("finallength"),r=e.get("turnconst"),u=e.get("leg"),d=e.get("direction"),g=e.get("approach"),f=a.get("latitude"),h=a.get("longitude"),p=a.get("variation"),v=a.get("groundspeed"),m=["u","c","d","b","f"];let y=m.indexOf(u);const w=i+90*("r"===d?1:-1),k=[i,w,i+180,w+180,i];let b=[];b[0]=calcLLfromHD(o,n,i,s+1.5,p),b[1]=calcLLfromHD(b[0][0],b[0][1],w,l,p),b[3]=calcLLfromHD(o,n,i+180,c,p),b[2]=calcLLfromHD(b[3][0],b[3][1],w,l,p),b[4]=[o,n];const L=calcLLdistance(f,h,b[y][0],b[y][1]);L<v/60/(r/v*60*toRad)&&(4!==y||4===y&&L<1)&&(y=(y+1)%5),4===y&&g&&(autoland.active=!0);const M=m[y],S=b[y][0],E=b[y][1],I=cyclical(k[y]);autofunction.cache.save("leg",M),autofunction.cache.save("flytolat",S),autofunction.cache.save("flytolong",E),autofunction.cache.save("flytohdg",I),flyto.active=!0})),autospeed=new autofunction("autospeed",1e3,["latref","longref","climbspd","spdref"],["onground","airspeed","verticalspeed","altitudeAGL","altitude","latitude","longitude","spd"],[],(t=>{const e=t.inputs,a=t.states,o=e.get("latref"),n=e.get("longref"),i=e.get("climbspd"),s=e.get("spdref"),l=a.get("onground"),c=a.get("airspeed"),r=a.get("verticalspeed"),u=a.get("altitudeAGL"),d=a.get("altitude"),g=a.get("latitude"),f=a.get("longitude"),h=a.get("spd");if(l)return void autospeed.arm();const p=autofunction.cache.load("altref").get("altref"),v=autofunction.cache.load("cruisespd").get("cruisespd"),m=null===p?u:d-p;if(autoland.active){let t=10*(calcLLdistance(g,f,o,n)-2.5)+s;t=Math.min(t,h),t=10*Math.round(t/10),t=Math.max(t,s),write("spd",t)}else flypattern.active||autotakeoff.active&&r>500&&m<=1e4&&i-c<10&&(write("spd",i),write("spdon",!0));r<-500&&m<=12e3&&m>=1e4&&write("spd",250),null!==v&&r>500&&m>1e4&&write("spd",v)})),goaround=new autofunction("goaround",-1,["climbalt","climbspd","climbtype","flapto"],["altitude","vs"],[levelchange,autoflaps,autogear,autospoilers],(t=>{const e=t.inputs,a=t.states,o=e.get("climbalt"),n=e.get("climbspd"),i=e.get("climbtype"),s=e.get("flapto"),l=a.get("altitude"),c=a.get("vs");autospeed.active=!1,autoland.error(),autofunction.cache.save("flcmode","g"),autofunction.cache.save("flcinput",500),autofunction.cache.save("leg","u");let r=o;const u="msl"===i,d=100*Math.round(l/100);r+=u?0:d,write("spd",n),write("alt",r),write("spdon",!0),write("alton",!0),write("flaps",s),c<0&&write("vs",0),flypattern.active=!0,setTimeout((()=>{levelchange.active=!0}),500),autoflaps.active=!0,autogear.active=!0,autospoilers.active=!0})),autoland=new autofunction("autoland",1e3,["latref","longref","altref","hdgref","vparef","flare","touchdown","option"],["latitude","longitude","altitude","groundspeed","onrunway"],[levelchange,autoflaps,autogear,autospeed,flypattern,goaround,autospoilers],(t=>{const e=t.inputs,a=t.states,o=e.get("latref"),n=e.get("longref"),i=e.get("altref"),s=e.get("hdgref"),l=e.get("vparef"),c=e.get("flare"),r=e.get("touchdown"),u=e.get("option"),d=a.get("latitude"),g=a.get("longitude"),f=a.get("altitude"),h=a.get("groundspeed"),p=a.get("onrunway");0===autoland.stage&&(autofunction.cache.save("leg","f"),autofunction.cache.save("flcmode","v"),autoland.stage++);const v=calcLLfromHD(o,n,s,r/6076.12),m=6076.12*calcLLdistance(d,g,v[0],v[1]);if(2===autoland.stage||m<=1e3)autoland.stage=2,autospeed.active=!1,levelchange.active=!1,autofunction.cache.save("flcmode","g"),autofunction.cache.save("flcinput",500),write("vs",-200),"p"!==u&&(write("spdon",!1),write("throttle",-100)),"p"===u?(autoland.active=!1,setTimeout((()=>{goaround.active=!0}),1e4)):"l"===u?(autoland.active=!1,flypattern.active=!1,flyto.active=!1):"t"===u&&p?(autoland.active=!1,setTimeout((()=>{autotakeoff.active=!0}),5e3)):"s"===u&&h<1&&(autoland.active=!1,autotakeoff.active=!0);else{const t=f-i,e=Math.asin(t/m)*toDeg;let a=2;m<=6076&&(a=.5);let o=e-a*(l-e);o=Math.round(10*o)/10,o=Math.min(o,l+.5),o<l-.5&&(o=0),autofunction.cache.save("flcinput",o);write("alt",i+c),levelchange.active=!0,autospeed.active=!0,flypattern.active=!0,autoflaps.active=!0,autospeed.active=!0,autospoilers.active=!0,autogear.active="p"!==u}})),rejecttakeoff=new autofunction("reject",-1,[],[],[],(t=>{autotakeoff.active?(autotakeoff.error(),write("throttle",-100)):rejecttakeoff.error()})),takeoffconfig=new autofunction("takeoffconfig",-1,["climbalt","climbtype"],["onground","heading","altitude"],[],(t=>{const e=t.inputs,a=t.states,o=e.get("climbalt"),n=e.get("climbtype"),i=e.get("onground"),s=a.get("heading"),l=a.get("altitude");if(!i)return void takeoffconfig.error();let c=o;const r="msl"===n,u=100*Math.round(l/100);c+=r?0:u,write("alt",c),write("hdg",s),write("vs",0),write("parkingbrake",!1)})),autotakeoff=new autofunction("autotakeoff",500,["rotate","climbspd","climbthrottle","takeoffspool","takeofflnav","takeoffvnav"],["onrunway","n1","airspeed"],[takeoffconfig,levelchange,autotrim,autogear,autoflaps,autospoilers,rejecttakeoff],(t=>{const e=t.inputs,a=t.states,o=e.get("rotate"),n=e.get("climbspd"),i=e.get("climbthrottle"),s=e.get("takeoffspool"),l=e.get("takeofflnav"),c=e.get("takeoffvnav"),r=a.get("onrunway"),u=a.get("n1"),d=a.get("airspeed"),g=2*i-100;let f=autotakeoff.stage;if(0===f){if(!r)return void autotakeoff.error();takeoffconfig.active=!0,levelchange.active=!1,autoland.active=!1,autogear.active=!0,autoflaps.active=!0,autospoilers.active=!0,write("spd",n),write("autopilot",!0),write("alton",!0),write("vson",!1),write("hdgon",!0);write("throttle",s?-20:g),f++}else 1===f?(write("vson",!0),s?(null===u||u>=40)&&(write("throttle",g),f++):f++):2===f?d>=o&&(levelchange.active=!0,f++):3===f?n-d<10&&(l&&write("navon",!0),c&&(vnavSystem.active=!0),write("spdon",!0),f++):autotakeoff.active=!1;autotakeoff.stage=f})),updatefpl=new autofunction("updatefpl",-1,[],["fplinfo"],[],(t=>{const e=t.states.get("fplinfo"),a=JSON.parse(e),o=a.detailedInfo.flightPlanItems,n=o.length-1,i=`index${n}children`,s=document.getElementById(i+"0"),l=o[n].children;if(null===l)return;const c=i+(l.length-1).toString(),r=document.getElementById(c);if(null===s||null!==l&&null===r){const t=document.getElementById("waypoints");t.innerHTML="";for(let e=0,n=o.length;e<n;e++){let n;const i=o[e].children;if(null===i)n=a.detailedInfo.waypoints[e],showfpl(`index${e}children0`,n,t);else for(let a=0,o=i.length;a<o;a++)n=i[a].identifier,showfpl(`index${e}children${a}`,n,t)}}}));function nextRestriction(t,e,a,o){return t.identifier!==e.name&&t.name!==e.name||(e.index=a,e.children=o,e.altitude=t.altitude),a>=e.index&&-1!==t.altitude&&(e.altitudeRestriction.push(t.altitude),e.restrictionLocation={lat:t.location.Latitude,long:t.location.Longitude}),e}const vnavSystem=new autofunction("vnav",1e3,[],["fplinfo","onground","autopilot","groundspeed","altitude","vnavon"],[],(t=>{const e=t.states,a=e.get("fplinfo"),o=e.get("onground"),n=e.get("autopilot"),i=e.get("groundspeed"),s=e.get("altitude"),l=e.get("vnavon");if(o||!n||l||levelchange.active)return void vnavSystem.error();updatefpl.active=!0;const c=JSON.parse(a),r=c.detailedInfo.flightPlanItems;let u={name:c.waypointName,index:-1,children:0,altitude:0,altitudeRestriction:[],altitudeRestrictionDistance:0,restrictionLocation:{lat:0,long:0}},d=vnavSystem.stage;for(let t=0,e=r.length;t<e;t++){const e=r[t],a=e.children;if(null===a)u=nextRestriction(e,u,t,0);else for(let e=0;e<a.length;e++)u=nextRestriction(a[t],u,t,e)}const g=`index${u.index}children${u.children}`,f=document.getElementById(g);if(null!==f&&"INPUT"===f.tagName){const t=f.value;""!==t&&c.distanceToNext<=10&&write("spd",t)}if(0===u.altitudeRestriction.length)return speak("No altitude restriction, VNAV disabled"),void vnavSystem.error();if(-1!==u.altitude){const t=(u.altitude-s)/c.eteToNext;write("alt",u.altitude),write("vs",t)}else{u.altitudeRestrictionDistance=calcLLdistance(c.nextWaypointLatitude,c.nextWaypointLongitude,u.restrictionLocation.lat,u.restrictionLocation.long);const t=(u.altitudeRestriction[0]-s)/((c.distanceToNext+u.altitudeRestrictionDistance)/i*60);write("alt",u.altitudeRestriction[0]),write("vs",t)}vnavSystem.stage=d}));let calloutFlags;const callout=new autofunction("callout",250,["rotate","minumuns"],["onrunway","airspeed","verticalspeed","throttle","gear","altitudeAGL","altitude"],[],(t=>{const e=t.inputs,a=t.states,o=e.get("rotate"),n=e.get("minumuns"),i=a.get("onrunway"),s=a.get("airspeed"),l=a.get("verticalspeed"),c=a.get("throttle"),r=a.get("gear"),u=a.get("altitudeAGL"),d=a.get("altitude"),g=o,f=o+10,h=autofunction.cache.load("altref").get("altref"),p=null===h?u:d-h;let v=callout.stage;0===v&&(calloutFlags=[!1,!1,!1,!1,!1,!1,!1,!1],v++),1===v&&s>=g&&i&&c>40?(speak("V1"),v++):2===v&&s>=o&&i&&c>40?(speak("Rotate"),v++):3===v&&s>=f&&c>40&&(speak("V2"),v++),!speechSynthesis.speaking&&l<-500&&!r&&p<=1e3&&speak("Landing Gear"),!speechSynthesis.speaking&&l<-500&&p<=n+10&&p>=n&&speak("Minimums");const m=[1e3,500,100,50,40,30,20,10];if(l<-500)for(let t=0,e=m.length-1;t<e;t++)if(!speechSynthesis.speaking&&p<=m[t]&&p>m[t+1]&&!calloutFlags[t]){speak(m[t]),calloutFlags[t]=!0;break}callout.stage=v})),autofunctions=[autotrim,autolights,autogear,autoflaps,levelchange,markposition,setrunway,flyto,flypattern,rejecttakeoff,takeoffconfig,autotakeoff,autoland,goaround,autospeed,autobrakes,vnavSystem,callout,updatefpl,autospoilers],socket=io();function bridge(){setVisibility(!0);let t=document.getElementById("address").value;const e=t.split(".");""!==t&&(e.length<2&&(t="1."+t),e.length<3&&(t="168."+t),e.length<4&&(t="192."+t)),socket.emit("bridge",t,(t=>{statLog.innerText=t,console.log(t)}))}function closeBridge(){reset(),socket.emit("break",(t=>{statLog.innerText=t,console.log(t)}))}function read(t,e=(t=>{})){socket.emit("read",t,(t=>{e(t)}))}function readAsync(t,e=(t=>{})){socket.emit("readAsync",t,(t=>{e(t)}))}function readLog(t){read(t,(t=>{console.log(t)}))}function write(t,e){socket.emit("write",t,e)}function setVisibility(t){for(let e=1,a=panels.length;e<a;e++){panels[e].hidden=t}}function reset(){setVisibility(!0),autofunctions.forEach((t=>{t.active&&(t.active=!1)}))}let statLog=document.getElementById("status"),panels=document.getElementsByClassName("panel");const storage=new profileStorage(document.getElementById("configselect")),select=document.getElementById("voices"),voices=speechSynthesis.getVoices();for(let t=0,e=voices.length;t<e;t++){const e=new Option(voices[t].lang,t.toString());select.add(e)}socket.emit("test",(t=>{statLog.innerText=t,console.log(t)})),socket.on("ready",(t=>{document.getElementById("address").value=t,setVisibility(!1)})),socket.on("log",(t=>{statLog.innerText=t,console.log(t)}));